---
title: "Implementing automated section control sprayers for optimising pesticide application in orchards"
author: "Clemens Stephany, Christoph Weinmann, Lucas Hoffmann, Adrian Fülle, Jasper Hackling"
date: "6/1/2021"
output: html_document
---

\ 

#### Description   
Reducing pesticide use: An analysis on the decision whether to implement an automated or manually operated section control sprayer in orchards.

\ 

#### Decision maker: farmer   
* Farmer is the main stakeholder who makes the decision whether or not to buy a modern sprayer which is able to minimise pesticide application rates

\ 

#### Stakeholders: (describe further)
* Farmer
  + importance: very high
  + Main Decision maker
  + Operator / User (knowledge about relevant orchards)
  + Budget for purchasing costs
  + profitable longterm?
  
* Manufacturer
  + importance: (very) low
  + Supplier
  + (takes feedback into account)

* Government
  + importance: medium - high
  + Bund/Länder - Arbeitsgemeinschaft Wasser (LAWA), Landwirtschaftskammer ...
  + Reduction of pesticide residues and unwanted effects
  + taking probes from products, groundwater, biodiversity (short & longterm)

* Consumers
  + importance: low - mid
  + no residues on products
  + inclined to buy farmers products

* Food retailers
  + same as consumers

* Society  
  + importance: low - mid
  + no active influence / Public image <br/> $\Rightarrow$  influencing government decisions (mindset about eg. Biodiversity)
 
* NGOs
  + importance: mid
  + Greenpeace, newspaper organizations, research centers / institutes
  + influencing society, consumers, government
  + newspaper, magazine article

* Water suppliers
  + importance: mid
  + conservation of healthy water bodies
  + food chains (plankton), fishing grounds, drinking water

* Agro-chemical companies
  + importance: low
  + keeping residues in environment low to prevent restrictive legislation (longterm)
  + BUT less sales of plant protection agents (shortterm)

* Local biodiversity
  + importance: high
  + higher diversity <br/> more pollinators <br/> reduces chance of diseases
  
* Beekeepers
  + importance: low - mid
  + less potential harm to bees


\ 

#### Problems:    
* Some common agrochemicals will be banned in the near future for various reasons
  + Overuse causes problems 
  + Public opinion is getting worse   
* Excessive use of pesticides can cause unwanted effects (e.g. resistances)  
* Agrochemicals are costly supplies <br/> $\Rightarrow$ reduction is welcome  

\ 

#### Options:  
* Buy automatic section control sprayer
* keeping / buying a manual section control sprayer
* Spray less pesticide with existing machinery 
* Adopt organic farming practices <br/> $\Rightarrow$ Use beneficiaries (beneficial organisms)
* Spray manually <br/> $\Rightarrow$ identify areas which need application <br/> $\Rightarrow$ application amount can be imprecise 

\ 

#### Allocation of resources:  
* Money
  + Overheads
  + Overheads        
  + Running costs 
* Labour 
  + Conducting actual tasks 
  + Acquiring know-how
* Pollinators  

\ 

#### Obstacles:  
* Costs of investment
* Learning curve for running the equipment 
* compatibility with current machinery

#### Uncertainties:  
* Potential reduction of pesticides using an automatic section controlled sprayer
  + Especially the reduction of excessive pesticides
* Common application rates of pesticides in orchards
* Potential Cost of an automatic section controlled sprayer
* Changing climate influencing the frequency of pesticides application
* Increased bee survival rate (as there still are pesticides, just less)
* Added value through increased bee survival and thus increasing pollination
* Governmental interest in pesticides reduction
* Image of a farmer trying to reduce pesticides but still using them
* Maintenance cost of an more complicated and sensitive system

#### (Sources of) information:
* Farmers
  + knowledge of the farm, knowledge of problems during application 
* Manufacturer (Currently developing a prototype)
  + Cost and capabilities of an automatic section control sprayer
* Landwirtschaftskammer NRW
  + Potential subsidisation of automatic section control sprayer
  + Political foreshadowing of future legislations
* (commercial) Beekeepers
  + How much of an problem are pesticides
* Consumers
  + Assess the importance/conception of reduced pesticide application to the consumer 


#### Flow chart using diagrammeR package 
```{r, include=FALSE}
library(DiagrammeR)
library(DiagrammeRsvg)
library(rsvg)
```


```{r, echo=FALSE}

model_flow_chart <- grViz("

digraph {
  
  # Add general information which counts for everything!!!
  
  # ---------
  # Change flow chart orientation (top down: 'TD'; left to right: 'LR' 
  rankdir = 'LR'
  
  # Add graph statements 
  graph [#label = 'Initial Model',
         labelloc = t,
         fontsize = 45,
         ranksep=2,
         nodesep=1]
  
  # Add node statements
  node [fontname = Arial,
        fontcolor = black,
        color = darkslategray,
        penwidth = 1]
  
  # Add edge statements
  edge [fontsize=30,
        penwidth=2,
        fontname=Arial]
  # ---------  
  
  # ---------  
  # create 'ranks' (basically nodes) for arranging nodes later on
  rank1 [style=invis]
  rank2 [style=invis]
  rank3 [style=invis]
  rank4 [style=invis]
  rank5 [style=invis]
  
  # make invisible (white) links between them
  rank1->rank2->rank3->rank4->rank5 [color=white]
  # ---------  
  
  # ---------  
  # Add specific statements for node group {Intervention & Alternatives} 
  node [shape = box,
        fontsize = 30,
        fixedsize = true,
        width = 3.6,
        height = 1.5]

    Ascs [label = 'Automated section \n control sprayer'];
    Al1 [label = 'Manual section \n control sprayer'];
#    Al2 [label = 'Trittleiter']
  # ---------
  
  
  
  # Add specific statements for node group {Pesticides & Cost} 
  # --------- 
  node [shape = box,
        fontsize = 28,
        fixedsize = true,
        width = 2.8,
        height = 0.9]
  
  Pe [label = 'Pesticides'];
  Co [label = 'Cost']
  
  Cu [label = 'Customers'];          
  Di [label = 'Diseases'];
  Bio [label = 'Biodiversity'];
  WC [label = 'Water \n contamination'];
  
  FS [label = 'Fruit sales'];
  GC [label = 'Government \n concerns'];
  
  FP [label = 'Farmers profit']
  
  # ---------  
  
  
  # Add edge statements for negative connection (arrows) and add the connections
  # ---------  
  edge [label = '-    ',
        fontcolor = 'red',
        color = 'red']
  {Ascs Al1}->Pe
#  Al2->Pe
  Pe->{Bio Di Cu}
  GC->FP
  WC->Bio
  Bio->{Di GC}
  Di->FS
  Co->FP
  # ---------  
  
  # Add edge statements for positive connection (arrows) and add the connections
  # ---------  
  edge [label = '+',
        fontcolor = 'forestgreen',
        color = 'forestgreen']
  
  {Ascs Al1}->Co
#  Al2->Co
  Pe->{WC Co} 
  FS->FP 
  WC->GC 
  Bio->FS
  Cu->FS
  # ---------  
  
  # ---------  
  # sorting the nodes per rank
  
  {
    rank1 -> Ascs -> Al1 [style=invis];
    # rank1 -> Ascs -> Al1 -> Al2 [style=invis];
    rank=same;
    rankdir=DT;
  }
  
  {
    rank2 -> Co -> Pe [style=invis];
    rank=same;
    rankdir=DT;
  }
  
  {
    rank3 -> Di -> Cu -> Bio -> WC [style=invis];
    rank=same;
    rankdir=DT;
  }
  
  # {
  #   rank4 -> FS -> GC [style=invis];
  #   rank=same;
  #   rankdir=DT;
  # }
# 
#   {
#     rank5 -> FS [style=invis];
#     rank=same;
#     rankdir=DT;
#   }
#   
  # ---------  
  
}")



# Plot flow chart 
model_flow_chart

# Export flow chart as .png files; save in "images" folder 
rsvg_png(charToRaw(export_svg(model_flow_chart)), "images/flow-chart.png") 

```

<!-- Not finished yet -->
<!-- #### Calculating the decision model {.tabset} -->
<!-- ##### Input -->
<!-- ```{r echo = FALSE} -->
<!-- # Input table for model function, adding Management_cost -->

<!-- input_estimates <- data.frame(variable = c("Farmers Profit", "Automated section control", "Pesticides", "Water contamination", " Customers", "Goverment concerens", "Biodiversity", "Diseases", "Fruit sales"), -->
<!--                               lower = c(6000, 3, 500, 100), -->
<!--                               median = NA, -->
<!--                               upper = c(14000, 8, 1000, 2000), -->
<!--                               distribution = c("posnorm", "posnorm", "posnorm", "posnorm"), -->
<!--                               label = c("Yield (kg/ha)", "Price (USD/kg)", "Labor cost (USD/ha)", "Management cost (USD/ha)"), -->
<!--                               Description = c("Yield in a sweet cherry farm under normal conditions", -->
<!--                                               "Price of sweet cherry in a normal season", -->
<!--                                               "Labor costs in a normal season",  -->
<!--                                               "Management costs in a normal season")) -->

<!-- ## Changing some columns as they are not in the right format (addition, maybe because R-base 3.6.3?) -->
<!-- input_estimates$distribution <- as.character(input_estimates$distribution) -->
<!-- input_estimates$variable <- as.character(input_estimates$variable) -->

<!-- # Show input_estimates table -->
<!-- input_estimates -->
<!-- ``` -->

<!-- ##### Model -->
<!-- ```{r} -->
<!-- # Creating model function to describe the graphical impact pathway (Diagram done earlier) -->
<!-- model_function <- function(){ -->

<!--   # Estimate the income in a normal season -->
<!--   income <- Yield * Market_price -->

<!--   # Estimate the overall cost in a normal season -->
<!--   overall_cost <- Labor_cost + Management_cost -->

<!--   # Estimate the final results from the model -->
<!--   final_result <- income - overall_cost -->

<!--   # Generate the list of outputs from the Monte Carlo simulation -->
<!--   return(list(final_result = final_result)) -->
<!-- } -->

<!-- # Run the Monte Carlo simulation using the model function -->
<!-- mc_simulation <- mcSimulation(estimate = as.estimate(input_estimates), -->
<!--                                     model_function = model_function, -->
<!--                                     numberOfModelRuns = 1000000, -->
<!--                                     functionSyntax = "plainNames") -->

<!-- # Print MonteCarlo simulation output -->
<!-- # mc_simulation -->

<!-- # Function for creating a random variable for a column from the input_estimates table  -->
<!-- # and put it in the global Env. for test purposes (faster that running whole model) -->
<!-- make_variables <- function(est,n=1) -->
<!-- { x<-random(rho=est, n=n) -->
<!-- for(i in colnames(x)) assign(i, -->
<!--                              as.numeric(x[1,i]),envir=.GlobalEnv) -->
<!-- } -->

<!-- # Creating random global variable from input_estimates -->
<!-- make_variables(as.estimate(input_estimates)) -->

<!-- # Call function (without parameters as they are in the global environment) -->
<!-- model_function() -->
<!-- ``` -->

<!-- ##### Graph {.active} -->
<!-- ```{r, echo=FALSE} -->

<!-- # Plot distributions to show outcome -->
<!-- plot_distributions(mcSimulation_object = mc_simulation, -->
<!--                    vars = "final_result", -->
<!--                    method = "hist_simple_overlay", -->
<!--                    old_names = "final_result", -->
<!--                    new_names = "Outcome distribution for profits") -->

<!-- ``` -->

 